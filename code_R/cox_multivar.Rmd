---
title: "R Notebook"
output: html_notebook
editor_options: 
  chunk_output_type: inline
---
 



# 0. Préliminaires

Necessaire que les evt soient numériques sinon pas pris en charge par la fonction coxph.

```{r}
 for(evt in c(var_evt,time_to_evt)){
   data5[,evt] = as.numeric(as.character(data5[,evt]))
   data5_std[,evt] = as.numeric(as.character(data5_std[,evt]))
   }
```


# 1. Modèles de Cox progressifs


Les analyses déjà faites avaient la structure suivante
1. Univarié
2. Modèle 1: age + sexe + tabac (qm16) + activité physique
3. Modèle 2: Modèle 1 + diabète + créatinine
4. Modèle 3: Modèle 2 + bmi
5. Modèle 4: Modèle 3 + mean blood pressure

## 1.1 Deces


### 1.1.1 Données brutes

```{r}
f1_deces_tos = formula(Surv(time_to_deces,deces) ~ age0 + sexe + qm16 + qm10, env = data5)

f2_deces_tos = formula(Surv(time_to_deces,deces) ~ age0 + sexe + qm16 + qm10 + diab + bio10, env = data5)

f3_deces_tos = formula(Surv(time_to_deces,deces) ~ age0 + sexe + qm16 + qm10 + diab + bio10 + bmi, env = data5)

f4_deces_tos = formula(Surv(time_to_deces,deces) ~ age0 + sexe + qm16 + qm10 + diab + bio10 + bmi + mbp, env = data5)

f5_deces_tos = formula(Surv(time_to_deces,deces) ~ sexe + qm16 + qm10 + diab + bio10 + bmi + mbp , env = data5)
```

```{r}
m1_deces_tos = cox_multivar2(f1_deces_tos,cox_univar_deces,data5, round = F)
m2_deces_tos = cox_multivar2(f2_deces_tos,cox_univar_deces,data5, round = F)
m3_deces_tos = cox_multivar2(f3_deces_tos,cox_univar_deces,data5, round = F)
m4_deces_tos = cox_multivar2(f4_deces_tos,cox_univar_deces,data5, round = F)
m5_deces_tos = cox_multivar2(f5_deces_tos,cox_univar_deces,data5, round = F)
```

#### 1.1.2 Données scaled

```{r}
f1_deces_tos_std = formula(Surv(time_to_deces,deces) ~ age0 + sexe + qm16 + qm10, env = data5_std)

f2_deces_tos_std = formula(Surv(time_to_deces,deces) ~ age0 + sexe + qm16 + qm10 + diab + bio10, env = data5_std)

f3_deces_tos_std = formula(Surv(time_to_deces,deces) ~ age0 + sexe + qm16 + qm10 + diab + bio10 + bmi, env = data5_std)

f4_deces_tos_std = formula(Surv(time_to_deces,deces) ~ age0 + sexe + qm16 + qm10 + diab + bio10 + bmi + mbp, env = data5_std)

f5_deces_tos_std = formula(Surv(time_to_deces,deces) ~ sexe + qm16 + qm10 + diab + bio10 + bmi + mbp , env = data5_std)
```


```{r}
m1_deces_tos_std = cox_multivar2(f1_deces_tos_std,cox_univar_all,data5_std, round = F)
m2_deces_tos_std = cox_multivar2(f2_deces_tos_std,cox_univar_all,data5_std, round = F)
m3_deces_tos_std = cox_multivar2(f3_deces_tos_std,cox_univar_all,data5_std, round = F)
m4_deces_tos_std = cox_multivar2(f4_deces_tos_std,cox_univar_all,data5_std, round = F)
m5_deces_tos_std = cox_multivar2(f5_deces_tos_std,cox_univar_all,data5_std, round = F)
```


## 1.2 CHD

### 1.2.1 Données brutes
```{r}
f1_chd_tos = formula(Surv(time_to_chd,chd) ~ age0 + sexe + qm16 + qm10, env = data5)
f2_chd_tos = formula(Surv(time_to_chd,chd) ~ age0 + sexe + qm16 + qm10 + diab + bio10, env = data5)
f3_chd_tos = formula(Surv(time_to_chd,chd) ~ age0 + sexe + qm16 + qm10 + diab + bio10 + bmi, env = data5)
f4_chd_tos = formula(Surv(time_to_chd,chd) ~ age0 + sexe + qm16 + qm10 + diab + bio10 + bmi + mbp, env = data5)
f5_chd_tos = formula(Surv(time_to_chd,chd) ~ sexe + qm16 + qm10 + diab + bio10 + bmi + mbp, env = data5)
```


```{r}
m1_chd_tos = cox_multivar2(f1_chd_tos,cox_univar_all,data5, round = F)
m2_chd_tos = cox_multivar2(f2_chd_tos,cox_univar_all,data5, round = F)
m3_chd_tos = cox_multivar2(f3_chd_tos,cox_univar_all,data5, round = F)
m4_chd_tos = cox_multivar2(f4_chd_tos,cox_univar_all,data5, round = F)
m4_chd_tos = cox_multivar2(f4_chd_tos,cox_univar_all,data5, round = F)
m5_chd_tos = cox_multivar2(f5_chd_tos,cox_univar_all,data5, round = F)
```

### 1.2.2 Données scaled
```{r}
f1_chd_tos_std = formula(Surv(time_to_chd,chd) ~ age0 + sexe + qm16 + qm10, env = data5_std)
f2_chd_tos_std = formula(Surv(time_to_chd,chd) ~ age0 + sexe + qm16 + qm10 + diab + bio10, env = data5_std)
f3_chd_tos_std = formula(Surv(time_to_chd,chd) ~ age0 + sexe + qm16 + qm10 + diab + bio10 + bmi, env = data5_std)
f4_chd_tos_std = formula(Surv(time_to_chd,chd) ~ age0 + sexe + qm16 + qm10 + diab + bio10 + bmi + mbp, env = data5_std)
f5_chd_tos_std = formula(Surv(time_to_chd,chd) ~ sexe + qm16 + qm10 + diab + bio10 + bmi + mbp, env = data3_std)
```


```{r}
m1_chd_tos_std = cox_multivar2(f1_chd_tos_std,cox_univar_all,data5_std, round = F)
m2_chd_tos_std = cox_multivar2(f2_chd_tos_std,cox_univar_all,data5_std, round = F)
m3_chd_tos_std = cox_multivar2(f3_chd_tos_std,cox_univar_all,data5_std, round = F)
m4_chd_tos_std = cox_multivar2(f4_chd_tos_std,cox_univar_all,data5_std, round = F)
m4_chd_tos_std = cox_multivar2(f4_chd_tos_std,cox_univar_all,data5_std, round = F)
m5_chd_tos_std = cox_multivar2(f5_chd_tos_std,cox_univar_all,data5_std, round = F)
```

# 2. Modèles de cox de comparaison

## 2.1 Modèles de base
```{r}
modele_base_deces_tos_std = coxph(Surv(time_to_deces,deces) ~ age0 + sexe + qm16 + qm10 + diab + bio10 + bmi + mbp, data = data5_std)
modele_base_chd_tos_std = coxph(Surv(time_to_chd,chd) ~ age0 + sexe + qm16 + qm10 + diab + bio10 + bmi + mbp, data = data5_std)
```


